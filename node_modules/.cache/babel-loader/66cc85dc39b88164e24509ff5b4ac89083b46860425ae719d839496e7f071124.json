{"ast":null,"code":"var _jsxFileName = \"D:\\\\ITechArt\\\\react-lab-2025\\\\application\\\\amplify-s3-gallery\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { S3Client, PutObjectCommand, ListObjectsV2Command } from \"@aws-sdk/client-s3\";\nimport { getSignedUrl } from \"@aws-sdk/s3-request-presigner\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst REGION = process.env.REACT_APP_AWS_REGION;\nconst BUCKET = process.env.REACT_APP_S3_BUCKET;\nconst ACCESS_KEY = process.env.REACT_APP_AWS_ACCESS_KEY_ID;\nconst SECRET_KEY = process.env.REACT_APP_AWS_SECRET_ACCESS_KEY;\nconst s3Client = new S3Client({\n  region: REGION,\n  credentials: {\n    accessKeyId: ACCESS_KEY,\n    secretAccessKey: SECRET_KEY\n  }\n});\nexport default function App() {\n  _s();\n  const [file, setFile] = useState(null);\n  const [images, setImages] = useState([]);\n\n  // Загрузка файла в S3\n  const uploadFile = async () => {\n    if (!file) return;\n    const key = `${Date.now()}-${file.name}`;\n    try {\n      await s3Client.send(new PutObjectCommand({\n        Bucket: BUCKET,\n        Key: key,\n        Body: file,\n        ContentType: file.type\n      }));\n      alert(\"File successfully uploaded!\");\n      loadImages();\n    } catch (err) {\n      console.error(\"Upload error:\", err);\n    }\n  };\n\n  // Получение списка файлов и генерация signed URL\n  const loadImages = async () => {\n    try {\n      const list = await s3Client.send(new ListObjectsV2Command({\n        Bucket: BUCKET\n      }));\n      const urls = await Promise.all((list.Contents || []).map(async obj => {\n        const url = await getSignedUrl(s3Client, new PutObjectCommand({\n          Bucket: BUCKET,\n          Key: obj.Key\n        }), {\n          expiresIn: 3600\n        });\n        return {\n          key: obj.Key,\n          url\n        };\n      }));\n      setImages(urls);\n    } catch (err) {\n      console.error(\"Error while getting list:\", err);\n    }\n  };\n  useEffect(() => {\n    loadImages();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: \"center\",\n      padding: 40,\n      fontFamily: \"Arial\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"React + AWS S3 (\\u0431\\u0435\\u0437 Amplify)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: e => setFile(e.target.files[0])\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: uploadFile,\n        style: {\n          marginLeft: 10\n        },\n        children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0432 S3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: loadImages,\n      children: \"Show all images and files\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        marginTop: 30\n      },\n      children: \"Galley\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"center\",\n        flexWrap: \"wrap\",\n        gap: 20\n      },\n      children: images.map(img => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: 200\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: img.url,\n          alt: \"preview\",\n          style: {\n            width: \"100%\",\n            height: \"auto\",\n            borderRadius: 8,\n            boxShadow: \"0 0 5px rgba(0,0,0,0.3)\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: img.key\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 13\n        }, this)]\n      }, img.key, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"4n0TPqNawjfRs1acd435vE6OFnY=\");\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","S3Client","PutObjectCommand","ListObjectsV2Command","getSignedUrl","jsxDEV","_jsxDEV","REGION","process","env","REACT_APP_AWS_REGION","BUCKET","REACT_APP_S3_BUCKET","ACCESS_KEY","REACT_APP_AWS_ACCESS_KEY_ID","SECRET_KEY","REACT_APP_AWS_SECRET_ACCESS_KEY","s3Client","region","credentials","accessKeyId","secretAccessKey","App","_s","file","setFile","images","setImages","uploadFile","key","Date","now","name","send","Bucket","Key","Body","ContentType","type","alert","loadImages","err","console","error","list","urls","Promise","all","Contents","map","obj","url","expiresIn","style","textAlign","padding","fontFamily","children","fileName","_jsxFileName","lineNumber","columnNumber","marginBottom","accept","onChange","e","target","files","onClick","marginLeft","marginTop","display","justifyContent","flexWrap","gap","img","width","src","alt","height","borderRadius","boxShadow","_c","$RefreshReg$"],"sources":["D:/ITechArt/react-lab-2025/application/amplify-s3-gallery/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  S3Client,\n  PutObjectCommand,\n  ListObjectsV2Command,\n} from \"@aws-sdk/client-s3\";\nimport { getSignedUrl } from \"@aws-sdk/s3-request-presigner\";\n\nconst REGION = process.env.REACT_APP_AWS_REGION;\nconst BUCKET = process.env.REACT_APP_S3_BUCKET;\nconst ACCESS_KEY = process.env.REACT_APP_AWS_ACCESS_KEY_ID;\nconst SECRET_KEY = process.env.REACT_APP_AWS_SECRET_ACCESS_KEY;\n\n\nconst s3Client = new S3Client({\n  region: REGION,\n  credentials: {\n    accessKeyId: ACCESS_KEY,\n    secretAccessKey: SECRET_KEY,\n  },\n});\n\nexport default function App() {\n  const [file, setFile] = useState(null);\n  const [images, setImages] = useState([]);\n\n  // Загрузка файла в S3\n  const uploadFile = async () => {\n    if (!file) return;\n    const key = `${Date.now()}-${file.name}`;\n    try {\n      await s3Client.send(\n        new PutObjectCommand({\n          Bucket: BUCKET,\n          Key: key,\n          Body: file,\n          ContentType: file.type,\n        })\n      );\n      alert(\"File successfully uploaded!\");\n      loadImages();\n    } catch (err) {\n      console.error(\"Upload error:\", err);\n    }\n  };\n\n  // Получение списка файлов и генерация signed URL\n  const loadImages = async () => {\n    try {\n      const list = await s3Client.send(\n        new ListObjectsV2Command({ Bucket: BUCKET })\n      );\n\n      const urls = await Promise.all(\n        (list.Contents || []).map(async (obj) => {\n          const url = await getSignedUrl(\n            s3Client,\n            new PutObjectCommand({ Bucket: BUCKET, Key: obj.Key }),\n            { expiresIn: 3600 }\n          );\n          return { key: obj.Key, url };\n        })\n      );\n\n      setImages(urls);\n    } catch (err) {\n      console.error(\"Error while getting list:\", err);\n    }\n  };\n\n  useEffect(() => {\n    loadImages();\n  }, []);\n\n  return (\n    <div style={{ textAlign: \"center\", padding: 40, fontFamily: \"Arial\" }}>\n      <h1>React + AWS S3 (без Amplify)</h1>\n\n      <div style={{ marginBottom: 20 }}>\n        <input\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={(e) => setFile(e.target.files[0])}\n        />\n        <button onClick={uploadFile} style={{ marginLeft: 10 }}>\n          Загрузить в S3\n        </button>\n      </div>\n\n      <button onClick={loadImages}>Show all images and files</button>\n\n      <h2 style={{ marginTop: 30 }}>Galley</h2>\n\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          flexWrap: \"wrap\",\n          gap: 20,\n        }}\n      >\n        {images.map((img) => (\n          <div key={img.key} style={{ width: 200 }}>\n            <img\n              src={img.url}\n              alt=\"preview\"\n              style={{\n                width: \"100%\",\n                height: \"auto\",\n                borderRadius: 8,\n                boxShadow: \"0 0 5px rgba(0,0,0,0.3)\",\n              }}\n            />\n            <p>{img.key}</p>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SACEC,QAAQ,EACRC,gBAAgB,EAChBC,oBAAoB,QACf,oBAAoB;AAC3B,SAASC,YAAY,QAAQ,+BAA+B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7D,MAAMC,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,oBAAoB;AAC/C,MAAMC,MAAM,GAAGH,OAAO,CAACC,GAAG,CAACG,mBAAmB;AAC9C,MAAMC,UAAU,GAAGL,OAAO,CAACC,GAAG,CAACK,2BAA2B;AAC1D,MAAMC,UAAU,GAAGP,OAAO,CAACC,GAAG,CAACO,+BAA+B;AAG9D,MAAMC,QAAQ,GAAG,IAAIhB,QAAQ,CAAC;EAC5BiB,MAAM,EAAEX,MAAM;EACdY,WAAW,EAAE;IACXC,WAAW,EAAEP,UAAU;IACvBQ,eAAe,EAAEN;EACnB;AACF,CAAC,CAAC;AAEF,eAAe,SAASO,GAAGA,CAAA,EAAG;EAAAC,EAAA;EAC5B,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAG1B,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAAC2B,MAAM,EAAEC,SAAS,CAAC,GAAG5B,QAAQ,CAAC,EAAE,CAAC;;EAExC;EACA,MAAM6B,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI,CAACJ,IAAI,EAAE;IACX,MAAMK,GAAG,GAAG,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIP,IAAI,CAACQ,IAAI,EAAE;IACxC,IAAI;MACF,MAAMf,QAAQ,CAACgB,IAAI,CACjB,IAAI/B,gBAAgB,CAAC;QACnBgC,MAAM,EAAEvB,MAAM;QACdwB,GAAG,EAAEN,GAAG;QACRO,IAAI,EAAEZ,IAAI;QACVa,WAAW,EAAEb,IAAI,CAACc;MACpB,CAAC,CACH,CAAC;MACDC,KAAK,CAAC,6BAA6B,CAAC;MACpCC,UAAU,CAAC,CAAC;IACd,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,eAAe,EAAEF,GAAG,CAAC;IACrC;EACF,CAAC;;EAED;EACA,MAAMD,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAI;MACF,MAAMI,IAAI,GAAG,MAAM3B,QAAQ,CAACgB,IAAI,CAC9B,IAAI9B,oBAAoB,CAAC;QAAE+B,MAAM,EAAEvB;MAAO,CAAC,CAC7C,CAAC;MAED,MAAMkC,IAAI,GAAG,MAAMC,OAAO,CAACC,GAAG,CAC5B,CAACH,IAAI,CAACI,QAAQ,IAAI,EAAE,EAAEC,GAAG,CAAC,MAAOC,GAAG,IAAK;QACvC,MAAMC,GAAG,GAAG,MAAM/C,YAAY,CAC5Ba,QAAQ,EACR,IAAIf,gBAAgB,CAAC;UAAEgC,MAAM,EAAEvB,MAAM;UAAEwB,GAAG,EAAEe,GAAG,CAACf;QAAI,CAAC,CAAC,EACtD;UAAEiB,SAAS,EAAE;QAAK,CACpB,CAAC;QACD,OAAO;UAAEvB,GAAG,EAAEqB,GAAG,CAACf,GAAG;UAAEgB;QAAI,CAAC;MAC9B,CAAC,CACH,CAAC;MAEDxB,SAAS,CAACkB,IAAI,CAAC;IACjB,CAAC,CAAC,OAAOJ,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;IACjD;EACF,CAAC;EAEDzC,SAAS,CAAC,MAAM;IACdwC,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,EAAE,CAAC;EAEN,oBACElC,OAAA;IAAK+C,KAAK,EAAE;MAAEC,SAAS,EAAE,QAAQ;MAAEC,OAAO,EAAE,EAAE;MAAEC,UAAU,EAAE;IAAQ,CAAE;IAAAC,QAAA,gBACpEnD,OAAA;MAAAmD,QAAA,EAAI;IAA4B;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAErCvD,OAAA;MAAK+C,KAAK,EAAE;QAAES,YAAY,EAAE;MAAG,CAAE;MAAAL,QAAA,gBAC/BnD,OAAA;QACEgC,IAAI,EAAC,MAAM;QACXyB,MAAM,EAAC,SAAS;QAChBC,QAAQ,EAAGC,CAAC,IAAKxC,OAAO,CAACwC,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAAE;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7C,CAAC,eACFvD,OAAA;QAAQ8D,OAAO,EAAExC,UAAW;QAACyB,KAAK,EAAE;UAAEgB,UAAU,EAAE;QAAG,CAAE;QAAAZ,QAAA,EAAC;MAExD;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,eAENvD,OAAA;MAAQ8D,OAAO,EAAE5B,UAAW;MAAAiB,QAAA,EAAC;IAAyB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAE/DvD,OAAA;MAAI+C,KAAK,EAAE;QAAEiB,SAAS,EAAE;MAAG,CAAE;MAAAb,QAAA,EAAC;IAAM;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAEzCvD,OAAA;MACE+C,KAAK,EAAE;QACLkB,OAAO,EAAE,MAAM;QACfC,cAAc,EAAE,QAAQ;QACxBC,QAAQ,EAAE,MAAM;QAChBC,GAAG,EAAE;MACP,CAAE;MAAAjB,QAAA,EAED/B,MAAM,CAACuB,GAAG,CAAE0B,GAAG,iBACdrE,OAAA;QAAmB+C,KAAK,EAAE;UAAEuB,KAAK,EAAE;QAAI,CAAE;QAAAnB,QAAA,gBACvCnD,OAAA;UACEuE,GAAG,EAAEF,GAAG,CAACxB,GAAI;UACb2B,GAAG,EAAC,SAAS;UACbzB,KAAK,EAAE;YACLuB,KAAK,EAAE,MAAM;YACbG,MAAM,EAAE,MAAM;YACdC,YAAY,EAAE,CAAC;YACfC,SAAS,EAAE;UACb;QAAE;UAAAvB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eACFvD,OAAA;UAAAmD,QAAA,EAAIkB,GAAG,CAAC9C;QAAG;UAAA6B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;MAAA,GAXRc,GAAG,CAAC9C,GAAG;QAAA6B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAYZ,CACN;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACtC,EAAA,CAjGuBD,GAAG;AAAA4D,EAAA,GAAH5D,GAAG;AAAA,IAAA4D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
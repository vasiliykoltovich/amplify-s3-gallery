{"ast":null,"code":"import { RpcProtocol } from \"@smithy/core/protocols\";\nimport { deref, NormalizedSchema, TypeRegistry } from \"@smithy/core/schema\";\nimport { getSmithyContext } from \"@smithy/util-middleware\";\nimport { CborCodec } from \"./CborCodec\";\nimport { loadSmithyRpcV2CborErrorCode } from \"./parseCborBody\";\nexport class SmithyRpcV2CborProtocol extends RpcProtocol {\n  codec = new CborCodec();\n  serializer = this.codec.createSerializer();\n  deserializer = this.codec.createDeserializer();\n  constructor({\n    defaultNamespace\n  }) {\n    super({\n      defaultNamespace\n    });\n  }\n  getShapeId() {\n    return \"smithy.protocols#rpcv2Cbor\";\n  }\n  getPayloadCodec() {\n    return this.codec;\n  }\n  async serializeRequest(operationSchema, input, context) {\n    const request = await super.serializeRequest(operationSchema, input, context);\n    Object.assign(request.headers, {\n      \"content-type\": this.getDefaultContentType(),\n      \"smithy-protocol\": \"rpc-v2-cbor\",\n      accept: this.getDefaultContentType()\n    });\n    if (deref(operationSchema.input) === \"unit\") {\n      delete request.body;\n      delete request.headers[\"content-type\"];\n    } else {\n      if (!request.body) {\n        this.serializer.write(15, {});\n        request.body = this.serializer.flush();\n      }\n      try {\n        request.headers[\"content-length\"] = String(request.body.byteLength);\n      } catch (e) {}\n    }\n    const {\n      service,\n      operation\n    } = getSmithyContext(context);\n    const path = `/service/${service}/operation/${operation}`;\n    if (request.path.endsWith(\"/\")) {\n      request.path += path.slice(1);\n    } else {\n      request.path += path;\n    }\n    return request;\n  }\n  async deserializeResponse(operationSchema, context, response) {\n    return super.deserializeResponse(operationSchema, context, response);\n  }\n  async handleError(operationSchema, context, response, dataObject, metadata) {\n    const errorName = loadSmithyRpcV2CborErrorCode(response, dataObject) ?? \"Unknown\";\n    let namespace = this.options.defaultNamespace;\n    if (errorName.includes(\"#\")) {\n      [namespace] = errorName.split(\"#\");\n    }\n    const errorMetadata = {\n      $metadata: metadata,\n      $fault: response.statusCode <= 500 ? \"client\" : \"server\"\n    };\n    const registry = TypeRegistry.for(namespace);\n    let errorSchema;\n    try {\n      errorSchema = registry.getSchema(errorName);\n    } catch (e) {\n      if (dataObject.Message) {\n        dataObject.message = dataObject.Message;\n      }\n      const synthetic = TypeRegistry.for(\"smithy.ts.sdk.synthetic.\" + namespace);\n      const baseExceptionSchema = synthetic.getBaseException();\n      if (baseExceptionSchema) {\n        const ErrorCtor = synthetic.getErrorCtor(baseExceptionSchema);\n        throw Object.assign(new ErrorCtor({\n          name: errorName\n        }), errorMetadata, dataObject);\n      }\n      throw Object.assign(new Error(errorName), errorMetadata, dataObject);\n    }\n    const ns = NormalizedSchema.of(errorSchema);\n    const ErrorCtor = registry.getErrorCtor(errorSchema);\n    const message = dataObject.message ?? dataObject.Message ?? \"Unknown\";\n    const exception = new ErrorCtor(message);\n    const output = {};\n    for (const [name, member] of ns.structIterator()) {\n      output[name] = this.deserializer.readValue(member, dataObject[name]);\n    }\n    throw Object.assign(exception, errorMetadata, {\n      $fault: ns.getMergedTraits().error,\n      message\n    }, output);\n  }\n  getDefaultContentType() {\n    return \"application/cbor\";\n  }\n}","map":{"version":3,"names":["RpcProtocol","deref","NormalizedSchema","TypeRegistry","getSmithyContext","CborCodec","loadSmithyRpcV2CborErrorCode","SmithyRpcV2CborProtocol","codec","serializer","createSerializer","deserializer","createDeserializer","constructor","defaultNamespace","getShapeId","getPayloadCodec","serializeRequest","operationSchema","input","context","request","Object","assign","headers","getDefaultContentType","accept","body","write","flush","String","byteLength","e","service","operation","path","endsWith","slice","deserializeResponse","response","handleError","dataObject","metadata","errorName","namespace","options","includes","split","errorMetadata","$metadata","$fault","statusCode","registry","for","errorSchema","getSchema","Message","message","synthetic","baseExceptionSchema","getBaseException","ErrorCtor","getErrorCtor","name","Error","ns","of","exception","output","member","structIterator","readValue","getMergedTraits","error"],"sources":["D:/ITechArt/react-lab-2025/application/node_modules/@aws-sdk/middleware-sdk-s3/node_modules/@smithy/core/dist-es/submodules/cbor/SmithyRpcV2CborProtocol.js"],"sourcesContent":["import { RpcProtocol } from \"@smithy/core/protocols\";\nimport { deref, NormalizedSchema, TypeRegistry } from \"@smithy/core/schema\";\nimport { getSmithyContext } from \"@smithy/util-middleware\";\nimport { CborCodec } from \"./CborCodec\";\nimport { loadSmithyRpcV2CborErrorCode } from \"./parseCborBody\";\nexport class SmithyRpcV2CborProtocol extends RpcProtocol {\n    codec = new CborCodec();\n    serializer = this.codec.createSerializer();\n    deserializer = this.codec.createDeserializer();\n    constructor({ defaultNamespace }) {\n        super({ defaultNamespace });\n    }\n    getShapeId() {\n        return \"smithy.protocols#rpcv2Cbor\";\n    }\n    getPayloadCodec() {\n        return this.codec;\n    }\n    async serializeRequest(operationSchema, input, context) {\n        const request = await super.serializeRequest(operationSchema, input, context);\n        Object.assign(request.headers, {\n            \"content-type\": this.getDefaultContentType(),\n            \"smithy-protocol\": \"rpc-v2-cbor\",\n            accept: this.getDefaultContentType(),\n        });\n        if (deref(operationSchema.input) === \"unit\") {\n            delete request.body;\n            delete request.headers[\"content-type\"];\n        }\n        else {\n            if (!request.body) {\n                this.serializer.write(15, {});\n                request.body = this.serializer.flush();\n            }\n            try {\n                request.headers[\"content-length\"] = String(request.body.byteLength);\n            }\n            catch (e) { }\n        }\n        const { service, operation } = getSmithyContext(context);\n        const path = `/service/${service}/operation/${operation}`;\n        if (request.path.endsWith(\"/\")) {\n            request.path += path.slice(1);\n        }\n        else {\n            request.path += path;\n        }\n        return request;\n    }\n    async deserializeResponse(operationSchema, context, response) {\n        return super.deserializeResponse(operationSchema, context, response);\n    }\n    async handleError(operationSchema, context, response, dataObject, metadata) {\n        const errorName = loadSmithyRpcV2CborErrorCode(response, dataObject) ?? \"Unknown\";\n        let namespace = this.options.defaultNamespace;\n        if (errorName.includes(\"#\")) {\n            [namespace] = errorName.split(\"#\");\n        }\n        const errorMetadata = {\n            $metadata: metadata,\n            $fault: response.statusCode <= 500 ? \"client\" : \"server\",\n        };\n        const registry = TypeRegistry.for(namespace);\n        let errorSchema;\n        try {\n            errorSchema = registry.getSchema(errorName);\n        }\n        catch (e) {\n            if (dataObject.Message) {\n                dataObject.message = dataObject.Message;\n            }\n            const synthetic = TypeRegistry.for(\"smithy.ts.sdk.synthetic.\" + namespace);\n            const baseExceptionSchema = synthetic.getBaseException();\n            if (baseExceptionSchema) {\n                const ErrorCtor = synthetic.getErrorCtor(baseExceptionSchema);\n                throw Object.assign(new ErrorCtor({ name: errorName }), errorMetadata, dataObject);\n            }\n            throw Object.assign(new Error(errorName), errorMetadata, dataObject);\n        }\n        const ns = NormalizedSchema.of(errorSchema);\n        const ErrorCtor = registry.getErrorCtor(errorSchema);\n        const message = dataObject.message ?? dataObject.Message ?? \"Unknown\";\n        const exception = new ErrorCtor(message);\n        const output = {};\n        for (const [name, member] of ns.structIterator()) {\n            output[name] = this.deserializer.readValue(member, dataObject[name]);\n        }\n        throw Object.assign(exception, errorMetadata, {\n            $fault: ns.getMergedTraits().error,\n            message,\n        }, output);\n    }\n    getDefaultContentType() {\n        return \"application/cbor\";\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}